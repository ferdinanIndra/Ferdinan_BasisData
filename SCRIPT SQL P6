CREATE TABLE pelanggan (
    id_pelanggan INT PRIMARY KEY AUTO_INCREMENT,
    nama_pelanggan VARCHAR(100),
    alamat TEXT,
    telepon VARCHAR(15)
);

CREATE TABLE produk (
    id_produk INT PRIMARY KEY AUTO_INCREMENT,
    nama_produk VARCHAR(100),
    harga DECIMAL(10, 2),
    stok INT
);

CREATE TABLE transaksi (
    id_transaksi INT PRIMARY KEY AUTO_INCREMENT,
    id_pelanggan INT,
    id_produk INT,
    jumlah INT,
    tanggal DATE,
    FOREIGN KEY (id_pelanggan) REFERENCES pelanggan(id_pelanggan),
    FOREIGN KEY (id_produk) REFERENCES produk(id_produk)
);



SELECT * FROM pelanggan;

SELECT * FROM produk WHERE stok < 10;

SELECT * FROM transaksi WHERE tanggal BETWEEN '2024-01-01' AND '2024-12-31';



INSERT INTO pelanggan (nama_pelanggan, alamat, telepon)
VALUES ('Satrio', 'Jl. Pam No. 5', '081234567891');

INSERT INTO pelanggan (nama_pelanggan, alamat, telepon)
VALUES ('Ferdinan', 'Jl. Ciputat No. 10', '081234567892');

INSERT INTO produk (nama_produk, harga, stok)
VALUES ('Laptop Lenovo ThinkPad', 15000000, 20),
       ('Laptop MacBook Air', 20000000, 15);


STORE PROCEDURE
DELIMITER //
CREATE PROCEDURE tambah_pelanggan (
    IN p_nama_pelanggan VARCHAR(100),
    IN p_alamat TEXT,
    IN p_telepon VARCHAR(15)
)
BEGIN
    INSERT INTO pelanggan (nama_pelanggan, alamat, telepon)
    VALUES (p_nama_pelanggan, p_alamat, p_telepon);
END //
DELIMITER ;

DELIMITER //
CREATE PROCEDURE update_stok_produk (
    IN p_id_produk INT,
    IN p_jumlah INT
)
BEGIN
    UPDATE produk SET stok = stok - p_jumlah WHERE id_produk = p_id_produk;
END //
DELIMITER ;

DELIMITER //
CREATE PROCEDURE update_stok_produk (
    IN p_id_produk INT,
    IN p_jumlah INT
)
BEGIN
    UPDATE produk SET stok = stok - p_jumlah WHERE id_produk = p_id_produk;
END //
DELIMITER ;

DELIMITER //
CREATE PROCEDURE tampilkan_laporan_transaksi (
    IN p_tanggal_awal DATE,
    IN p_tanggal_akhir DATE
)
BEGIN
    SELECT * FROM transaksi
    WHERE tanggal BETWEEN p_tanggal_awal AND p_tanggal_akhir;
END //
DELIMITER ;

CALL tambah_pelanggan('Dwi', 'Jl. Ciater No. 6', '0812589291');
CALL tambah_pelanggan('Indra', 'Jl. Sawah No. 9', '081234544301');
CALL update_stok_produk(1, 5); 




